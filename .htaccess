AddType application/x-httpd-php56 .php .php5

# BEGIN WordPress
<IfModule mod_rewrite.c>

RewriteEngine On

# This translates the header added by an upstream proxy (eg, a load balancer)
# which terminates SSL. WP expects a variable HTTPS, but the proxy gives us another indicator. We need to map the two.

# First, a condition; then, a rule.

# 1. The condition. If the header X-Forwarded-Proto has the value https
# 2. The rule. The syntax is:
# RewriteRule Pattern Substitution [flags]
# Pattern .* means "match everything"
# Substitution: - means "no change"
# [E=VAR:VAL] add the variable ENV with the value VAL
RewriteCond %{HTTP:X-Forwarded-Proto} https
RewriteRule .* - [E=HTTPS:on]

# Next, unless the protocol is already https, redirect to the https version.
# This will catch anyone trying to access via http
# If we are behind a proxy, then HTTPS will be set (as above)
# If not, then HTTPS will be set directly anyway
RewriteCond %{HTTP:HTTPS} !on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

RewriteRule ^index\.php$ - [L]

RewriteRule ^members https://members.spastriders.co.uk [L,R=301]
RewriteRule ^register https://members.spastriders.co.uk/users/register [L,R=301]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress